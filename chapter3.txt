This is the initial version of chapter3.