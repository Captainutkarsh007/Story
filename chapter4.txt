This is the initial version of chapter4.